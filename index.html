<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cosas Aleix - Firestore</title>
<style>
body { font-family: Arial, sans-serif; background: #f0f0f0; margin: 0; padding: 0; }
.container { max-width: 600px; margin: 20px auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
h1 { text-align: center; }
input, button { padding: 10px; margin: 5px 0; width: 100%; border-radius: 6px; border: 1px solid #ccc; }
button { background: #28a745; color: white; border: none; cursor: pointer; }
table { width: 100%; border-collapse: collapse; margin-top: 20px; }
th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
img { width: 50px; border-radius: 4px; }
</style>
</head>
<body>

<div class="container">
  <h1>Cosas Aleix</h1>

  <input id="price" type="number" placeholder="Precio €">
  <input id="link" placeholder="URL del producto">
  <input id="image" placeholder="URL de la imagen">
  <button id="addBtn">Añadir Producto</button>

  <table>
    <thead>
      <tr>
        <th>Imagen</th>
        <th>Precio</th>
        <th>Link</th>
      </tr>
    </thead>
    <tbody id="products"></tbody>
  </table>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBTobN1gD7fhXYiwH1w7dYQLWi3bFZoBjU",
  authDomain: "cosas-af46c.firebaseapp.com",
  projectId: "cosas-af46c",
  storageBucket: "cosas-af46c.firebasestorage.app",
  messagingSenderId: "145996030094",
  appId: "1:145996030094:web:2f8f38fdbde5d6d386e9df"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const productosCol = collection(db, "productos");

const priceInput = document.getElementById("price");
const linkInput = document.getElementById("link");
const imageInput = document.getElementById("image");
const addBtn = document.getElementById("addBtn");
const tbody = document.getElementById("products");

// Añadir producto
addBtn.addEventListener("click", async () => {
  const price = Number(priceInput.value);
  const link = linkInput.value.trim();
  const image = imageInput.value.trim();

  if (!price || !link || !image) {
    alert("Rellena precio, link y URL de imagen");
    return;
  }

  await addDoc(productosCol, { price, link, image });
  priceInput.value = "";
  linkInput.value = "";
  imageInput.value = "";
});

// Mostrar productos en tiempo real
onSnapshot(productosCol, (snapshot) => {
  tbody.innerHTML = "";
  snapshot.forEach(docItem => {
    const p = docItem.data();
    tbody.innerHTML += `
      <tr>
        <td><img src="${p.image}" alt="Imagen"></td>
        <td>${p.price.toFixed(2)} €</td>
        <td><a href="${p.link}" target="_blank">Ver</a></td>
      </tr>
    `;
  });
});
</script>

</body>
</html>
